{% extends "base.html" %}

{% block content %}
<!-- Hero Section -->
<section class="max-w-7xl mx-auto px-4 pt-20 pb-12 text-center">
    <span
        class="inline-block px-4 py-2 rounded-full bg-brand-50 dark:bg-brand-900/30 text-brand-600 dark:text-brand-400 text-xs font-bold tracking-widest uppercase mb-6">
        Powered by OpenAI & RiskEngineâ„¢
    </span>
    <h1 class="text-5xl md:text-7xl font-extrabold mb-8 tracking-tight max-w-4xl mx-auto leading-tight">
        Master Your Financial <span class="gradient-text">DNA</span> with AI
    </h1>
    <p class="text-xl text-slate-500 dark:text-slate-400 mb-10 max-w-2xl mx-auto leading-relaxed">
        Upload your bank statements and get a comprehensive risk analysis, spending categorization, and a professional
        roadmap to financial health in seconds.
    </p>

    <div class="flex flex-wrap justify-center gap-4 mb-20">
        <button onclick="document.getElementById('upload-section').scrollIntoView({behavior: 'smooth'})"
            class="px-8 py-4 bg-brand-600 text-white font-bold rounded-2xl hover:bg-brand-700 transition shadow-xl shadow-brand-500/20 text-lg">
            Analyze My Statement
        </button>
        <button
            class="px-8 py-4 bg-white dark:bg-slate-800 text-slate-900 dark:text-white font-bold rounded-2xl hover:bg-gray-50 dark:hover:bg-slate-700 transition border border-gray-200 dark:border-slate-700 text-lg">
            View Sample Report
        </button>
    </div>

    <!-- Trust Symbols -->
    <div class="max-w-4xl mx-auto opacity-50 flex flex-wrap justify-center gap-12 items-center grayscale">
        <span class="font-bold text-lg italic">FINTECH WEEKLY</span>
        <span class="font-bold text-lg italic">GLOBAL RISK ASSESS</span>
        <span class="font-bold text-lg italic">BANKSECURE</span>
        <span class="font-bold text-lg italic">AI DAILY</span>
    </div>
</section>

<!-- Features Grid -->
<section class="bg-gray-100 dark:bg-slate-800/50 py-24">
    <div class="max-w-7xl mx-auto px-4">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div class="glass p-8 rounded-3xl group hover:-translate-y-2 transition duration-300">
                <div
                    class="w-12 h-12 bg-blue-100 dark:bg-blue-900/40 text-blue-600 dark:text-blue-400 rounded-xl flex items-center justify-center mb-6 group-hover:rotate-12 transition">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                </div>
                <h3 class="text-xl font-bold mb-4">Instant Categorization</h3>
                <p class="text-slate-500 dark:text-slate-400">Our proprietary AI model automatically buckets your
                    transactions into 12+ smart categories with 99.9% accuracy.</p>
            </div>
            <div class="glass p-8 rounded-3xl group hover:-translate-y-2 transition duration-300">
                <div
                    class="w-12 h-12 bg-green-100 dark:bg-green-900/40 text-green-600 dark:text-green-400 rounded-xl flex items-center justify-center mb-6 group-hover:rotate-12 transition">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                </div>
                <h3 class="text-xl font-bold mb-4">Proprietary Risk Score</h3>
                <p class="text-slate-500 dark:text-slate-400">Get a clear 0-100 health score based on debt-to-income,
                    savings rate, and spending efficiency metrics.</p>
            </div>
            <div class="glass p-8 rounded-3xl group hover:-translate-y-2 transition duration-300">
                <div
                    class="w-12 h-12 bg-purple-100 dark:bg-purple-900/40 text-purple-600 dark:text-purple-400 rounded-xl flex items-center justify-center mb-6 group-hover:rotate-12 transition">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                    </svg>
                </div>
                <h3 class="text-xl font-bold mb-4">Export Analysis</h3>
                <p class="text-slate-500 dark:text-slate-400">Download a professional, bank-ready PDF report detailing
                    your financial position and improvement steps.</p>
            </div>
        </div>
    </div>
</section>

<!-- Upload Section -->
<section id="upload-section" class="max-w-4xl mx-auto px-4 py-24">
    <div
        class="glass p-12 rounded-[40px] shadow-2xl relative overflow-hidden border border-brand-200 dark:border-slate-700">
        <div class="absolute -top-24 -right-24 w-64 h-64 bg-brand-500/10 rounded-full blur-3xl"></div>
        <div class="absolute -bottom-24 -left-24 w-64 h-64 bg-brand-600/10 rounded-full blur-3xl"></div>

        <div class="relative z-10">
            <h2 class="text-3xl font-extrabold mb-2 text-center">Ready to begin?</h2>
            <p class="text-slate-500 dark:text-slate-400 text-center mb-10">Upload your statement in CSV format. Your
                data is encrypted and discarded after processing.</p>

            <div id="drop-zone"
                class="border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-3xl p-12 text-center hover:border-brand-500 dark:hover:border-brand-400 transition cursor-pointer group mb-10">
                <input type="file" id="csv-file" class="hidden" accept=".csv">
                <div
                    class="bg-brand-50 dark:bg-slate-800 w-20 h-20 rounded-2xl flex items-center justify-center mx-auto mb-6 group-hover:scale-110 transition shadow-inner">
                    <svg class="w-10 h-10 text-brand-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12">
                        </path>
                    </svg>
                </div>
                <p class="text-xl font-bold mb-2">Select your CSV File</p>
                <p class="text-sm text-slate-500 dark:text-slate-400">Drag and drop or click to browse</p>
            </div>

            <div class="flex flex-col md:flex-row gap-4">
                <div class="relative flex-1">
                    <span class="absolute left-4 top-1/2 -translate-y-1/2 text-slate-400">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.206">
                            </path>
                        </svg>
                    </span>
                    <input type="email" id="user-email" placeholder="you@example.com"
                        class="w-full pl-12 pr-4 py-4 rounded-2xl bg-white dark:bg-slate-800 border-gray-200 dark:border-slate-700 focus:ring-2 focus:ring-brand-500 outline-none shadow-sm transition">
                </div>
                <button id="analyze-btn"
                    class="px-10 py-4 bg-brand-600 text-white font-bold rounded-2xl hover:bg-brand-700 transition shadow-xl shadow-brand-500/20 whitespace-nowrap">
                    Generate Analysis
                </button>
            </div>

            <div id="status-message"
                class="mt-6 hidden text-center p-4 rounded-xl bg-brand-50 dark:bg-brand-900/20 text-brand-700 dark:text-brand-300 font-medium">
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script>
    const zone = document.getElementById('drop-zone');
    const input = document.getElementById('csv-file');
    const btn = document.getElementById('analyze-btn');
    const emailInput = document.getElementById('user-email');
    const status = document.getElementById('status-message');

    zone.onclick = () => input.click();

    // Drag and Drop
    zone.addEventListener('dragover', (e) => { e.preventDefault(); zone.classList.add('border-brand-500'); });
    zone.addEventListener('dragleave', () => { zone.classList.remove('border-brand-500'); });
    zone.addEventListener('drop', (e) => {
        e.preventDefault();
        zone.classList.remove('border-brand-500');
        input.files = e.dataTransfer.files;
        status.classList.remove('hidden');
        status.innerHTML = `Selected: ${input.files[0].name}`;
    });

    input.onchange = () => {
        if (input.files[0]) {
            status.classList.remove('hidden');
            status.innerHTML = `Selected: ${input.files[0].name}`;
        }
    };

    btn.onclick = async () => {
        if (!input.files[0] || !emailInput.value) {
            alert('Please provide both an email and a CSV file.');
            return;
        }

        btn.disabled = true;
        btn.innerHTML = '<span class="flex items-center gap-2"><svg class="animate-spin h-5 w-5 text-white" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Processing...</span>';
        status.classList.remove('hidden');
        status.innerHTML = 'AI is categorizing your transactions... This takes about 10 seconds.';
        status.className = 'mt-6 text-center p-4 rounded-xl bg-brand-50 dark:bg-brand-900/20 text-brand-700 dark:text-brand-300 font-medium animate-pulse';

        const formData = new FormData();
        formData.append('file', input.files[0]);
        formData.append('email', emailInput.value);

        try {
            const response = await fetch('/upload', {
                method: 'POST',
                body: formData
            });

            const data = await response.json();
            if (response.ok) {
                // Redirect to specialized processing page for feedback
                window.location.href = `/processing/${data.report_id}`;
            } else {
                status.innerHTML = `Error: ${data.error}`;
                status.className = 'mt-6 text-center p-4 rounded-xl bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 font-medium';
            }
        } catch (e) {
            status.innerHTML = 'An unexpected error occurred.';
            status.className = 'mt-6 text-center p-4 rounded-xl bg-red-50 dark:bg-red-900/20 text-red-700 dark:text-red-300 font-medium';
        } finally {
            btn.disabled = false;
            btn.innerHTML = 'Generate Analysis';
        }
    };
</script>
{% endblock %}